<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Bexco - 행사장 임대</title>
    <link rel="stylesheet" href="common/css/common.css">
    <link rel="stylesheet" href="common/css/rental.css">
    <link rel="stylesheet" href="common/css/jquery-ui.css">
    <meta property="og:title" content="Bexco - 행사장 임대">
    <meta property="og:description" content="Bexco 행사장을 임대할 수 있는 페이지입니다.">
    <meta property="og:image" content="images/01.jpg">
</head>
<body>
    <div id="wrap">
        <div class="header">
            <div class="header__upper">
                <div class="container">
                    <div class="logo">
                        <a href="index.html">
                            <img src="/assets/logo.png" alt="벡스코" title="벡스코">
                        </a>
                    </div>
                </div>
            </div>
            <div class="header__downer">
                <div class="container">
                    <ul class="menu">
                        <li><a href="rental.html">행사장 임대</a></li>
                        <li><a href="transportation.html">교통편 예약</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="title-section">
            <div class="title-section__text">
                <div class="title-section__title">행사장 임대</div>
                <div class="title-section__description">행사장을 임대할 수 있는 페이지입니다.</div>
            </div>
        </div>
        <div class="content">
            <div class="container">
                <table class="placements">
                    <thead>
                        <tr>
                            <th style="width: 140px">행사장 사진</th>
                            <th style="width: 200px">행사장 이름</th>
                            <th>행사장 소개</th>
                            <th style="width: 200px">휴무일</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="placement">
                            <td>
                                <div class="placement__frame"></div>
                            </td>
                            <td class="placement__title">

                            </td>
                            <td>
                               <div class="placement__description"></div> 
                               <div class="placement__score"></div>
                            </td>
                            <td class="placement__rest">

                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="reservation-dialog">asd</div>
    <script
    src="https://code.jquery.com/jquery-3.4.1.js"
    integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
    crossorigin="anonymous"></script>
    <script
    src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"
    integrity="sha256-T0Vest3yCU7pafRw9r+settMBX6JkKN06dqBnpQ8d30="
    crossorigin="anonymous"></script>
    <script>
        function on(event, target, callback) {
            $(document).on(event, target, callback);
        }

        var reservations = [];
        var placements = [];

        $.get('/data/reservation.json').then((data) => {
            reservations = data.reservations;
            return $.get('/data/placement.json');
        }).then((data) => {
            placements = data.places;
            PlacementTable.draw(placements);
        });

        var PlacementTable = {
            table: '.placements',
            thead: '.placements thead',
            tbody: '.placements tbody',
            row: $('.placements tbody tr').get(0),
            draw(placements) {
                this.clear();
                for (var i = 0; i < placements.length; i += 1) {
                    var placement = placements[i];
                    var clone = $(this.row).clone();

                    var name = placement.name;
                    var score = placement.score;
                    var description = placement.description;
                    var price = placement.price;
                    var rest = placement.rest;
                    var image = placement.image;
                    var restKor = [];
                    rest.forEach((index) => { restKor.push(RestFilter.get(index)); });

                    clone.find('.placement__frame').css('background-image', `url(${`images/${image}`})`);
                    clone.find('.placement__title').text(name);
                    clone.find('.placement__description').text(description);
                    clone.find('.placement__rest').text(restKor.join(', '));
                    $(this.tbody).append(clone);
                }
            },
            clear() {
                $(this.tbody).html('');
            },
        };

        var RestFilter = {
            data: ['일', '월', '화', '수', '목', '금', '토'],
            get(index) {
                return this.data[index] || null;
            },
        };

        var ReservationDialog = {
            target: $('.reservation-dialog').dialog(),
            init() {
                this.target.dialog('close');
            },
            visible(flag) {
                flag ? this.target.dialog('open') : this.target.dialog('close');
            },
        };
        ReservationDialog.init();

        on('click', `${PlacementTable.tbody} tr`, () => {
            ReservationDialog.visible(true);
        });
    </script>
</body>
</html>